{{- if .Values.minAvailable -}}
{{- if semverCompare "<v1.21.0-0" .Capabilities.KubeVersion.Version }}
apiVersion: policy/v1beta1
{{- else }}
apiVersion: policy/v1
{{- end }}
kind: PodDisruptionBudget
metadata:
  name: {{ template "catalog.fullname" . }}-pdb
  labels: {{- include "common.labels.standard" . | nindent 4 }}
    {{- if .Values.deploymentLabels }}
    {{- include "common.tplvalues.render" (dict "value" .Values.deploymentLabels "context" $) | nindent 4 }}
    {{- end }}
spec:
  selector:
    matchLabels: {{- include "common.labels.standard" . | nindent 6 }}
      {{- if .Values.deploymentLabels }}
      {{- include "common.tplvalues.render" (dict "value" .Values.deploymentLabels "context" $) | nindent 6 }}
      {{- end }}
  minAvailable: {{ .Values.minAvailable }}
{{- end }}